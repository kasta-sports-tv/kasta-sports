<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://cdn.jsdelivr.net/npm/video.js@8.12.0/dist/video-js.min.css" rel="stylesheet"/>
<link href="https://cdn.jsdelivr.net/npm/videojs-mobile-ui@1.0.1/dist/videojs-mobile-ui.css" rel="stylesheet"/>

<style>
html, body { margin:0; padding:0; background:#000; height:100%; overflow:hidden; }
.player-container { position: relative; width:100%; height:100vh; background:#000; }
.video-js { position:absolute; top:0; left:0; width:100% !important; height:100% !important; object-fit:contain !important; background:#000 !important; }

.vjs-control-bar { background: rgba(0,0,0,0.65) !important; }
.vjs-control { color:#fff !important; transition: all 0.2s ease; }
.vjs-control:hover { color:#ff0000 !important; }
.vjs-play-control, .vjs-fullscreen-control { color:#ff0000 !important; }
.vjs-big-play-button { color:#ff0000 !important; border:2px solid #ff0000 !important; }
.vjs-quality-selector .vjs-menu { width:12em !important; left:-4.5em !important; }
.vjs-menu li { text-transform:none; }
.vjs-quality-menu-wrapper .vjs-menu { width:12em !important; left:-4.5em !important; }
.vjs-quality-menu-item-sub-label { display:none; }

/* Водяний знак */
.player-watermark {
  pointer-events:none;
  z-index:9999;
  position:absolute;
  filter: drop-shadow(0 0 6px rgba(0,191,255,0.8)) drop-shadow(0 0 12px rgba(173,216,230,0.6));
  transition: all 0.3s ease;
  opacity:0;
}
.player-watermark img { display:block; width:90px; height:auto; pointer-events:none; }
</style>
</head>

<body>

<div class="player-container" id="videoContainer">
  <video-js
    id="video-player"
    class="vjs-luxmty vjs-16-9 vjs-show-big-play-button-on-pause"
    controls
    preload="auto"
    playsinline
  >
    <source src="https://cors.orestlutij9.workers.dev/?url=https://playertv.xyz/site3/video.m3u8" type="application/x-mpegURL" />
  </video-js>

  <div class="player-watermark" id="wm">
    <img src="https://dl.dropbox.com/scl/fi/5f91hwjnaxeduve9dpsmv/IMG_20251101_134848.png?rlkey=zp6loeqvic2bsve388qei887o" alt="watermark">
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/video.js@8.12.0/dist/video.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/videojs-mobile-ui@1.0.1/dist/videojs-mobile-ui.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/EmilioSG11/videojs-hls-quality-selector@main/dist/videojs-hls-quality-selector.js"></script>
<script src="https://cdn.jsdelivr.net/npm/videojs-logo@3.0.0/dist/videojs-logo.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/videojs-contextmenu-ui@7.0.0/dist/videojs-contextmenu-ui.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/videojs-contrib-quality-menu@1.0.1/dist/videojs-contrib-quality-menu.js"></script>

<script>
// Ініціалізація плеєра
const player = videojs("video-player", {
  liveui: true,
  responsive: true,
  fluid: false,
  controlBar: {
    children: [
      'playToggle','volumePanel','currentTimeDisplay','progressControl',
      'liveDisplay','seekToLive','durationDisplay','customControlSpacer',
      'audioTrackButton','pictureInPictureToggle','qualitySelector','fullscreenToggle'
    ]
  }
});

player.mobileUi();
player.hlsQualitySelector({ displayCurrentQuality: true });
player.contextmenuUI();

player.logo({
  image: "https://dl.dropbox.com/scl/fi/5f91hwjnaxeduve9dpsmv/IMG_20251101_134848.png?rlkey=zp6loeqvic2bsve388qei887o",
  url: "https://google.com"
});

// Водяний знак з твоєї логіки
(function(){
  const wm = document.getElementById("wm");
  const wmImg = wm.querySelector("img");

  player.ready(() => {
    const techEl = player.el().querySelector('.vjs-tech') || player.el();
    techEl.parentNode.appendChild(wm);

    const baseWidth = 90;

    function updateWatermark() {
      const isFullscreen = player.isFullscreen && player.isFullscreen();
      const isDesktop = window.innerWidth > 768;

      if(isFullscreen){
        if(isDesktop){ wmImg.style.width=(baseWidth*3.4)+"px"; wm.style.top="9%"; wm.style.right="1%"; }
        else { wmImg.style.width=(baseWidth*1.2)+"px"; wm.style.top="4%"; wm.style.right="10%"; }
      } else {
        if(isDesktop){ wmImg.style.width=(baseWidth*2.4)+"px"; wm.style.top="6%"; wm.style.right="2%"; }
        else { wmImg.style.width=baseWidth+"px"; wm.style.top="3%"; wm.style.right="4%"; }
      }

      wm.style.opacity = "1";
    }

    player.on("fullscreenchange", updateWatermark);
    window.addEventListener("resize", updateWatermark);
    document.addEventListener("fullscreenchange", updateWatermark);
    document.addEventListener("webkitfullscreenchange", updateWatermark);

    player.on("playing", ()=> wm.style.opacity="1");
    player.on("pause", ()=> wm.style.opacity="1");
    player.on("ended", ()=> wm.style.opacity="0");

    setTimeout(updateWatermark, 300);
  });
})();

// Fix spacebar для паузи/відтворення
document.addEventListener("keydown", e=>{
  if(e.code==="Space"){ e.preventDefault(); if(player.paused()) player.play(); else player.pause(); }
});
</script>

</body>
</html>
