<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–ê–¥–∞–ø—Ç–∏–≤–Ω–∏–π Video.js 16/9</title>
<link href="https://unpkg.com/video.js@7.10.2/dist/video-js.min.css" rel="stylesheet">

<style>
  body {
    margin: 0;
    background: #000;
  }

  .video-container {
    width: 100%;
    height: 100%;
    position: relative;
    padding-top: 56.25%;
    overflow: hidden;
  }

  .video-container .video-js {
    position: absolute;
    top: 0;
    left: 0;
    width: 100% !important;
    height: 100% !important;
  }

  .video-js .vjs-control-bar {
    box-sizing: border-box;
  }

  .video-watermark {
    pointer-events: none;
    z-index: 9999;
    position: absolute;
    filter: drop-shadow(0 0 6px rgba(0,191,255,0.8))
            drop-shadow(0 0 12px rgba(173,216,230,0.6));
    transition: all 0.3s ease;
  }
</style>
</head>
<body>

<div class="video-container" id="videoContainer">
  <video id="videoPlayer" class="video-js vjs-default-skin" controls preload="auto" playsinline></video>

  <div class="video-watermark" id="wm">
    <img src="https://imgpx.com/QNw0mYKgAwaA.png">
  </div>
</div>

<script src="https://unpkg.com/video.js@7.10.2/dist/video.min.js"></script>
<script>

  function getQueryVariable(variable) {
    const query = window.location.search.substring(1);
    const vars = query.split("&");
    for (let i = 0; i < vars.length; i++) {
      const pair = vars[i].split("=");
      if (pair[0] === variable) return decodeURIComponent(pair[1]);
    }
    return null;
  }

  const nowPlayVideoUrl =
    getQueryVariable("url") ||
    "https://example.com/video.mp4"; // –∑–∞–ø–∞—Å–Ω–µ MP4

  // üî• –ê–≤—Ç–æ–≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Ç–∏–ø—É
  function detectType(url) {
    if (url.includes(".m3u8")) return "application/x-mpegURL";
    if (url.includes(".mp4")) return "video/mp4";
    return "video/mp4"; // –∑–∞–ø–∞—Å–Ω–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç
  }

  const options = {
    autoplay: false,
    muted: false,
    preload: "auto",
    controls: true
  };

  let player = videojs("videoPlayer", options, function () {
    this.src([{ src: nowPlayVideoUrl, type: detectType(nowPlayVideoUrl) }]);
  });

  window.addEventListener("unload", function () {
    if (player) player.dispose();
  });

  // ==== WATERMARK ====
  const wm = document.getElementById("wm");
  const wmImg = wm.querySelector("img");
  const playerEl = document.querySelector(".video-js");
  playerEl.appendChild(wm);

  const baseWidth = 80;

  function updateWatermark() {
    const isFullscreen =
      document.fullscreenElement ||
      document.webkitFullscreenElement ||
      player.isFullscreen();
    const isDesktop = window.innerWidth > 768;

    if (isFullscreen) {
      if (isDesktop) {
        wmImg.style.width = baseWidth * 2.8 + "px";
        wm.style.top = "10%";
        wm.style.right = "6%";
      } else {
        wmImg.style.width = baseWidth * 1.4 + "px";
        wm.style.top = "4%";
        wm.style.right = "10%";
      }
    } else {
      if (isDesktop) {
        wmImg.style.width = baseWidth * 2.0 + "px";
        wm.style.top = "6%";
        wm.style.right = "5%";
      } else {
        wmImg.style.width = baseWidth + "px";
        wm.style.top = "3%";
        wm.style.right = "4%";
      }
    }
  }

  player.on("fullscreenchange", updateWatermark);
  window.addEventListener("resize", updateWatermark);
  document.addEventListener("fullscreenchange", updateWatermark);
  document.addEventListener("webkitfullscreenchange", updateWatermark);

  setTimeout(updateWatermark, 300);
</script>

</body>
</html>
