<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Video.js Player –∑ —Ñ—ñ–∫—Å–æ–≤–∞–Ω–∏–º Watermark</title>

<link href="https://cdn.jsdelivr.net/npm/video.js@8.12.0/dist/video-js.min.css" rel="stylesheet"/>
<link href="https://cdn.jsdelivr.net/npm/videojs-mobile-ui@1.0.1/dist/videojs-mobile-ui.css" rel="stylesheet"/>

<style>
html, body {
    margin: 0;
    padding: 0;
    background: #000;
    height: 100%;
    overflow: hidden;
}

.player-container {
    position: relative;
    width: 100%;
    aspect-ratio: 16/9;
}

.video-js {
    position: absolute !important;
    width: 100% !important;
    height: 100% !important;
    top: 0;
    left: 0;
}

/* –°—Ç–∏–ª—å –≤–æ–¥—è–Ω–æ–≥–æ –∑–Ω–∞–∫—É */
.player-watermark {
    position: absolute;
    pointer-events: none;
    z-index: 9999;
    display: none;
}
.player-watermark img {
    display: block;
}
</style>
</head>
<body>

<div class="player-container">
    <video-js
        id="video-player"
        class="vjs-16-9 vjs-big-play-centered"
        controls
        preload="auto"
        playsinline
    >
        <source id="video-source" src="https://bitcdn-kronehit.bitmovin.com/v2/hls/chunklist.m3u8" type="application/x-mpegURL"/>
    </video-js>
</div>

<script src="https://cdn.jsdelivr.net/npm/video.js@8.12.0/dist/video.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/videojs-mobile-ui@1.0.1/dist/videojs-mobile-ui.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/EmilioSG11/videojs-hls-quality-selector@main/dist/videojs-hls-quality-selector.js"></script>

<script>

// ‚úÖ –û—Ç—Ä–∏–º—É—î–º–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ iframe
const params = new URLSearchParams(window.location.search);
const streamUrl = params.get("url");
const posterUrl = params.get("poster");

const videoEl = document.getElementById("video-player");
const sourceEl = document.getElementById("video-source");

// —è–∫—â–æ –ø–µ—Ä–µ–¥–∞–ª–∏ url
if(streamUrl){
    sourceEl.src = streamUrl;
}

// —è–∫—â–æ –ø–µ—Ä–µ–¥–∞–ª–∏ –ø–æ—Å—Ç–µ—Ä
if(posterUrl){
    videoEl.setAttribute("poster", posterUrl);
}

const player = videojs("video-player", {
    liveui: true,
    responsive: true,
    fluid: false
});

// Mobile UI
player.mobileUi();

// HLS —è–∫—ñ—Å—Ç—å
player.hlsQualitySelector({ displayCurrentQuality: true });

// üî• Watermark
player.ready(function() {
    const playerEl = player.el();

    const wmContainer = document.createElement('div');
    wmContainer.className = 'player-watermark';

    const wmImg = document.createElement('img');
    wmImg.src = "https://dl.dropbox.com/scl/fi/5f91hwjnaxeduve9dpsmv/IMG_20251101_134848.png?rlkey=zp6loeqvic2bsve388qei887o";

    wmContainer.appendChild(wmImg);
    playerEl.appendChild(wmContainer);

    const baseWidth = 80;

    function updateWatermark() {
        const isFullscreen = player.isFullscreen();
        const isDesktop = window.innerWidth > 768;

        if(isFullscreen) {
            if(isDesktop){
                wmImg.style.width = (baseWidth * 3) + "px";
                wmContainer.style.top = "8%";
                wmContainer.style.right = "1%";
            } else {
                wmImg.style.width = (baseWidth * 1.2) + "px";
                wmContainer.style.top = "4%";
                wmContainer.style.right = "10%";
            }
        } else {
            if(isDesktop){
                wmImg.style.width = (baseWidth * 1.8) + "px";
                wmContainer.style.top = "6%";
                wmContainer.style.right = "2%";
            } else {
                wmImg.style.width = baseWidth + "px";
                wmContainer.style.top = "3%";
                wmContainer.style.right = "4%";
            }
        }
    }

    player.one("playing", () => {
        wmContainer.style.display = "block";
        updateWatermark();
    });

    player.on("fullscreenchange", updateWatermark);
    window.addEventListener("resize", updateWatermark);

    setTimeout(updateWatermark, 300);
});

</script>

</body>
</html>
